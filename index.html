<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SKN44 Physics</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #ff9ecf, #8fd3ff);
  text-align: center;
  margin: 0;
  padding: 10px;
  color: white;
}

h1 { margin: 10px 0; }

.stats {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 10px;
  font-size: 16px;
  flex-wrap: wrap;
}

.game-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  max-width: 900px;
  margin: auto;
}

.column {
  background: white;
  padding: 10px;
  border-radius: 15px;
  box-shadow: 0 8px 15px rgba(0,0,0,0.3);
  color: black;
}

.card {
  background: #ffe3f1;
  margin: 6px;
  padding: 8px;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.3s;
  font-size: 14px;
}

.card:hover { background: #cde9ff; }

.selected { background: #ffb3d9 !important; }

.correct {
  background: #a5d6a7 !important;
  pointer-events: none;
}

button {
  margin-top: 10px;
  padding: 8px 15px;
  font-size: 14px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}

#leaderboard {
  background: white;
  color: black;
  margin-top: 15px;
  padding: 10px;
  border-radius: 15px;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}

@media(max-width:700px){
  .game-container { grid-template-columns: 1fr; }
}
</style>
</head>

<body>

<h1>üéÆ SKN44_Physics</h1>

<div class="stats">
  ‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="score">0</span>
  ‚è± ‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer">60</span>s
</div>

<button onclick="resetGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>

<div class="game-container">
  <div class="column">
    <h3>‡∏™‡∏π‡∏ï‡∏£</h3>
    <div id="formulas"></div>
  </div>

  <div class="column">
    <h3>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏π‡∏ï‡∏£</h3>
    <div id="names"></div>
  </div>
</div>

<div id="leaderboard">
  <h3>üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
  <ol id="scores"></ol>
</div>

<script>
// ‚ùó ‡πÉ‡∏™‡πà Firebase Config ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏ó‡∏ô YOUR_PROJECT
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT.firebaseio.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const questionPool = [
  ["Q = mcŒîT","‡∏™‡∏π‡∏ï‡∏£‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô"],
  ["Q = mL","‡∏™‡∏π‡∏ï‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πâ‡∏≠‡∏ô‡πÅ‡∏ù‡∏á"],
  ["P‚ÇÅV‚ÇÅ = P‚ÇÇV‚ÇÇ","‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏ö‡∏≠‡∏¢‡∏•‡πå"],
  ["V‚ÇÅ/T‚ÇÅ = V‚ÇÇ/T‚ÇÇ","‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏ä‡∏≤‡∏£‡πå‡∏•"],
  ["P‚ÇÅ/T‚ÇÅ = P‚ÇÇ/T‚ÇÇ","‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏¢‡πå-‡∏•‡∏π‡∏™‡πÅ‡∏ã‡∏Å"],
  ["PV = nRT","‡∏™‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πä‡∏™‡∏≠‡∏∏‡∏î‡∏°‡∏Ñ‡∏ï‡∏¥"]
];

let usedQuestions = [];
let selectedFormula = null;
let selectedName = null;
let score = 0;
let timeLeft = 60;
let timer;

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function startTimer(){
  clearInterval(timer);
  timeLeft = 60;
  document.getElementById("timer").textContent = timeLeft;

  timer = setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").textContent = timeLeft;

    if(timeLeft <= 0){
      endGame();
    }
  },1000);
}

function getRandomQuestions(){
  let available = questionPool.filter(q => !usedQuestions.includes(q[0]));

  if(available.length === 0){
    usedQuestions = [];
    available = questionPool;
  }

  const selected = shuffle(available).slice(0,3);
  selected.forEach(q => usedQuestions.push(q[0]));
  return selected;
}

function createCards(){
  const questions = getRandomQuestions();
  const formulas = shuffle(questions.map(q=>q[0]));
  const names = shuffle(questions.map(q=>q[1]));

  const fDiv = document.getElementById("formulas");
  const nDiv = document.getElementById("names");

  fDiv.innerHTML = "";
  nDiv.innerHTML = "";

  formulas.forEach(f=>{
    const card = document.createElement("div");
    card.className = "card";
    card.textContent = f;
    card.onclick = ()=>selectFormula(card, questions);
    fDiv.appendChild(card);
  });

  names.forEach(n=>{
    const card = document.createElement("div");
    card.className = "card";
    card.textContent = n;
    card.onclick = ()=>selectName(card, questions);
    nDiv.appendChild(card);
  });
}

function selectFormula(card, questions){
  if(selectedFormula) selectedFormula.classList.remove("selected");
  selectedFormula = card;
  card.classList.add("selected");
  check(questions);
}

function selectName(card, questions){
  if(selectedName) selectedName.classList.remove("selected");
  selectedName = card;
  card.classList.add("selected");
  check(questions);
}

function check(questions){
  if(selectedFormula && selectedName){

    const correctPair = questions.find(q=>q[0]===selectedFormula.textContent);

    if(correctPair && correctPair[1]===selectedName.textContent){

      selectedFormula.classList.add("correct");
      selectedName.classList.add("correct");

      score += 10;   // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
      document.getElementById("score").textContent = score;

      setTimeout(()=>{
        createCards();
      },500);

    } else {

      score -= 5;
      if(score < 0) score = 0;
      document.getElementById("score").textContent = score;
    }

    selectedFormula.classList.remove("selected");
    selectedName.classList.remove("selected");
    selectedFormula = null;
    selectedName = null;
  }
}

function endGame(){
  clearInterval(timer);
  alert("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ " + score);

  const playerName = prompt("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:");
  if(playerName){
    database.ref("scores").push({
      name: playerName,
      score: score
    });
  }
}

function loadLeaderboard(){
  database.ref("scores")
    .orderByChild("score")
    .limitToLast(5)
    .on("value", snapshot=>{
      const scoresList = document.getElementById("scores");
      scoresList.innerHTML = "";

      const data = [];
      snapshot.forEach(child=>{
        data.push(child.val());
      });

      data.reverse().forEach(item=>{
        const li = document.createElement("li");
        li.textContent = item.name + " - " + item.score;
        scoresList.appendChild(li);
      });
    });
}

function resetGame(){
  score = 0;
  usedQuestions = [];
  document.getElementById("score").textContent = score;
  createCards();
  startTimer();
}

loadLeaderboard();
resetGame();

</script>

</body>
</html>
